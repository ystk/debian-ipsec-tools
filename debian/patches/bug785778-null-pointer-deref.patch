Description: CVE-2015-4047: Fix NULL pointer dereference in racoon
Origin: other, http://seclists.org/fulldisclosure/2015/May/83
Bug-Debian: https://bugs.debian.org/785778
Forwarded: no
Author: christos@zoulas.com (Christos Zoulas)
Last-Update: 2015-05-21

--- a/src/racoon/gssapi.c
+++ b/src/racoon/gssapi.c
@@ -192,6 +192,11 @@ gssapi_init(struct ph1handle *iph1)
 	gss_name_t princ, canon_princ;
 	OM_uint32 maj_stat, min_stat;
 
+	if (iph1->rmconf == NULL) {
+		plog(LLV_ERROR, LOCATION, NULL, "no remote config\n");
+		return -1;
+	}
+
 	gps = racoon_calloc(1, sizeof (struct gssapi_ph1_state));
 	if (gps == NULL) {
 		plog(LLV_ERROR, LOCATION, NULL, "racoon_calloc failed\n");
